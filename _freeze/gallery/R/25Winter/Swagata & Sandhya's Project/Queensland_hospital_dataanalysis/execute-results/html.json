{
  "hash": "38bff325e7c5c09c4dfe4d796b4f6941",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Queensland hospitals data analysis\"\nauthor: \"Swagata & Sandhya\"\nformat: html\ndate: 17 July 2025\n# editor: visual\ncategories: [R, 25Winter, \"data: hospital_data.csv\"]\n---\n\n## Quarto uses Markdown\n\nQuarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.\n\n## Running Code\n\nWhen you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"dplyr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(\"ggplot2\")\nlibrary(\"plotly\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'plotly'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(\"tidyverse\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ lubridate 1.9.4     ✔ tibble    3.2.1\n✔ purrr     1.0.4     ✔ tidyr     1.3.1\n✔ readr     2.1.5     \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ plotly::filter() masks dplyr::filter(), stats::filter()\n✖ dplyr::lag()     masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nhospital_data <- read.csv('../../../../data/hospital_data.csv')\n\n\n# Aggregate data per hospital (mean if multiple entries per hospital)\nplot_data <- hospital_data %>%\n  group_by(Facility.HHS.Desc) %>%\n  summarise(avg_no_wait = mean(Patients.who.did.not.wait.for.treatment...., na.rm = TRUE)) %>%\n  arrange(desc(avg_no_wait)) %>%\n  slice_max(avg_no_wait, n = 20)  # Top 20\n\n# Create clearer horizontal barplot\nggplot(plot_data, aes(x = reorder(Facility.HHS.Desc, \n                                  avg_no_wait),\n                      y = avg_no_wait,\n                      fill = avg_no_wait)) +\n  geom_col(show.legend = FALSE) +\n  coord_flip() +\n  labs(\n    title = \"Top 20 Hospitals by % of Patients Who Left Without Treatment\",\n    x = \"Hospital\",\n    y = \"% of Patients Who Did Not Wait\"\n  ) +\n  scale_fill_gradient(low = \"skyblue\", high = \"red\") +\n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5),\n    axis.text.y = element_text(size = 11)\n  )\n```\n\n::: {.cell-output-display}\n![](Queensland_hospital_dataanalysis_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Calculate the average % of patients who did not wait per hospital\n\nbottom_20_plot_data <- hospital_data %>%\n  group_by(Facility.HHS.Desc) %>%\n  summarise(avg_no_wait = mean(Patients.who.did.not.wait.for.treatment...., \n                               na.rm = TRUE)) %>%\n  arrange(avg_no_wait) %>%\n  slice_min(avg_no_wait, n = 20)  # Bottom 20 hospitals\n\n# Plot: bottom 20 hospitals with the lowest no-wait percentage\nggplot(bottom_20_plot_data, aes(x = reorder(Facility.HHS.Desc, avg_no_wait), y = avg_no_wait, fill = avg_no_wait)) +\n  geom_col(show.legend = FALSE) +\n  coord_flip() +\n  labs(\n    title = \"Bottom 20 Hospitals by % of Patients Who Left Without Treatment\",\n    x = \"Hospital\",\n    y = \"% of Patients Who Did Not Wait\"\n  ) +\n  scale_fill_gradient(low = \"forestgreen\", high = \"yellow\") +\n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5),\n    axis.text.y = element_text(size = 11))\n```\n\n::: {.cell-output-display}\n![](Queensland_hospital_dataanalysis_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Summarize total attendances per hospital (in case of duplicates or multiple rows)\ntop_20_attendance <- hospital_data %>%\n  group_by(Facility.HHS.Desc) %>%\n  summarise(total_attendances = sum(Number.of.Attendances, na.rm = TRUE)) %>%\n  arrange(desc(total_attendances)) %>%\n  slice_max(total_attendances, n = 20)\n\n\n# Plot the top 20 hospitals by attendance\nggplot(top_20_attendance, aes(x = reorder(Facility.HHS.Desc, total_attendances),\n                              y = total_attendances,\n                              fill = total_attendances)) +\n  geom_col(show.legend = FALSE) +\n  coord_flip() +\n  labs(\n    title = \"Top 20 Hospitals by Number of Attendances\",\n    x = \"Hospital\",\n    y = \"Number of Attendances\"\n  ) +\n  scale_fill_gradient(low = \"lightblue\", high = \"darkblue\") +\n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5),\n    axis.text.y = element_text(size = 11)\n  )\n```\n\n::: {.cell-output-display}\n![](Queensland_hospital_dataanalysis_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Filter for Triage 1, calculate average wait time, select top 20\nhospital_data |>\n  filter(Triage.Category == \"1\") |>\n  group_by(Facility.HHS.Desc) |>\n  summarise(avg_wait = mean(Median.Waiting.time.to.treatment..minutes., na.rm = TRUE)) |>\n  arrange(desc(avg_wait)) |>\n  slice_max(avg_wait, n = 20) |>\n  ggplot(aes(x = reorder(Facility.HHS.Desc, avg_wait), y = avg_wait)) +\n  geom_col(fill = \"darkred\") +\n  geom_text(aes(label = round(avg_wait, 1)), hjust = -0.1, size = 3.5, color = \"black\") +\n  coord_flip() +\n  scale_y_continuous(limits = c(0, 120)) +\n  labs(\n    title = \"Top 20 Hospitals by Average Wait Time (Triage 1)\",\n    x = \"Hospital\",\n    y = \"Average Waiting Time (Minutes)\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(face = \"bold\", hjust = 0.5),\n        axis.text.y = element_text(size = 11))\n```\n\n::: {.cell-output-display}\n![](Queensland_hospital_dataanalysis_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# Analyze data by center\nTop_20 <- hospital_data%>%\n  filter(Facility.HHS.Desc!=\"Queensland\", Facility.HHS.Desc!=\"QUEENSLAND\")%>%\n  group_by(Facility.HHS.Desc)%>% \n  summarise(Number.of.Attendances = mean(Number.of.Attendances, na.rm=TRUE))%>%\n  arrange(desc(Number.of.Attendances))%>%\n  slice_max(Number.of.Attendances, n=20) \nTop_20 <- arrange(Top_20, desc(Number.of.Attendances))\n\n\n\n\nlibrary(forcats)\n#Visualize using ggplot\nggplot(Top_20, aes(x = fct_inorder(Facility.HHS.Desc), y = Number.of.Attendances)) +\n  geom_col(fill = \"steelblue\") +\n  labs(title = \"Hospital Attendances\",\n       x = \"Facility\",\n       y = \"Number of Attendances\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Queensland_hospital_dataanalysis_files/figure-html/unnamed-chunk-1-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# Step 1: Identify top 10 hospitals by total attendance\ntop_10_hospitals <- hospital_data |>\n  group_by(Facility.HHS.Desc) |>\n  summarise(total_attendance = sum(Number.of.Attendances, na.rm = TRUE), .groups = \"drop\") |>\n  arrange(desc(total_attendance)) |>\n  slice_max(total_attendance, n = 10)\n\n# Step 2: Filter main dataset for only these top hospitals\ntop_data <- hospital_data |>\n  filter(Facility.HHS.Desc %in% top_10_hospitals$Facility.HHS.Desc)\n\n# Step 3: Compute average waiting time for heatmap\nheatmap_data <- top_data |>\n  group_by(Facility.HHS.Desc, Triage.Category) |>\n  summarise(Avg_Wait = mean(Median.Waiting.time.to.treatment..minutes., na.rm = TRUE), .groups = \"drop\")\n\n# Step 4: Create heatmap\nggplot(heatmap_data, aes(x = Triage.Category, y = Facility.HHS.Desc, fill = Avg_Wait)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient(\n    name = \"Avg Wait (min)\",\n    low = \"lightyellow\",   # shortest waits\n    high = \"darkred\",      # longest waits\n    na.value = \"grey90\"\n  ) +\n  labs(\n    title = \"Avg Waiting Time (Top 10 Hospitals by Attendance)\",\n    x = \"Triage Category\",\n    y = \"Hospital\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    axis.text.y = element_text(size = 9),\n    plot.title = element_text(hjust = 0.5, face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Queensland_hospital_dataanalysis_files/figure-html/unnamed-chunk-1-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# Group and summarise\ncor_data <- hospital_data |>\n  group_by(Facility.HHS.Desc) |>\n  summarise(\n    avg_wait = mean(Median.Waiting.time.to.treatment..minutes., na.rm = TRUE),\n    total_attendance = sum(Number.of.Attendances, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\n# Pearson correlation\ncor.test(cor_data$avg_wait, cor_data$total_attendance, method = \"pearson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  cor_data$avg_wait and cor_data$total_attendance\nt = 1.528, df = 208, p-value = 0.128\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.03046599  0.23736356\nsample estimates:\n     cor \n0.105359 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Create contingency table\nwait_table <- table(hospital_data$Triage.Category, hospital_data$Patients.who.did.not.wait.for.treatment....)\n\n\n\n# Chi-square test\nchisq.test(wait_table)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in chisq.test(wait_table): Chi-squared approximation may be incorrect\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  wait_table\nX-squared = 20474, df = 16662, p-value < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nhospital_data |>\n  group_by(Facility.HHS.Desc) |>\n  summarise(\n    mean_wait = mean(Median.Waiting.time.to.treatment..minutes., na.rm = TRUE),\n    sd_wait = sd(Median.Waiting.time.to.treatment..minutes., na.rm = TRUE),\n    iqr_wait = IQR(Median.Waiting.time.to.treatment..minutes., na.rm = TRUE),\n    .groups = \"drop\"\n  ) |>\n  arrange(desc(mean_wait)) |> \n  slice_head(n = 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 4\n   Facility.HHS.Desc        mean_wait sd_wait iqr_wait\n   <chr>                        <dbl>   <dbl>    <dbl>\n 1 Caloundra Hospital            66.6    32.3     40.5\n 2 Roma Hospital                 66.5    43.3     85.3\n 3 Cooktown Hospital             65.0    40.8     78.1\n 4 Thursday Island Hospital      65.0    45.5     93.7\n 5 Longreach Hospital            64.8    45.3     92.0\n 6 Bamaga Hospital               64.8    42.0     86.2\n 7 Doomadgee Hospital            64.7    43.5     89.1\n 8 Moranbah Hospital             64.6    46.0     94.6\n 9 Cherbourg Hospital            64.4    40.3     78.5\n10 Charleville Hospital          64.2    47.9    100  \n```\n\n\n:::\n\n```{.r .cell-code}\n# Simple linear model\nlm_model <- lm(Median.Waiting.time.to.treatment..minutes. ~ Triage.Category + Number.of.Attendances, data = hospital_data)\nsummary(lm_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Median.Waiting.time.to.treatment..minutes. ~ Triage.Category + \n    Number.of.Attendances, data = hospital_data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-63.24 -49.29  17.57  38.75  47.62 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(>|t|)    \n(Intercept)            5.573e+01  1.112e+00  50.115  < 2e-16 ***\nTriage.Category2      -3.334e+00  1.532e+00  -2.177  0.02952 *  \nTriage.Category3      -1.425e+00  1.532e+00  -0.930  0.35249    \nTriage.Category4       3.045e+00  1.531e+00   1.989  0.04677 *  \nTriage.Category5       7.514e+00  1.530e+00   4.910 9.24e-07 ***\nTriage.CategoryAll    -4.580e+01  4.223e+00 -10.844  < 2e-16 ***\nTriage.CategoryALL     4.218e+00  1.566e+00   2.694  0.00708 ** \nNumber.of.Attendances -2.778e-05  1.602e-05  -1.734  0.08295 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 41.71 on 9266 degrees of freedom\n  (168 observations deleted due to missingness)\nMultiple R-squared:  0.02211,\tAdjusted R-squared:  0.02137 \nF-statistic: 29.92 on 7 and 9266 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n```r\nggplot(hospital_data, aes(x = Number.of.Attendances, y = Median.Waiting.time.to.treatment..minutes.)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  labs(title = \"Effect of Attendance on Waiting Time\", x = \"Attendances\", y = \"Waiting Time (min)\") +\n  theme_minimal()\n```\n\nYou can add options to executable code like this\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4\n```\n\n\n:::\n:::\n\n\nThe `echo: false` option disables the printing of code (only output is displayed).",
    "supporting": [
      "Queensland_hospital_dataanalysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}